(function(_ds){var window=this;var JP=function(a){var b=a.Mf,c=a.Yb,d=a.credentials,e=a.od,f=a.pd,g=a.ag,h=a.eg,k=a.yd,l=a.projectId,m=a.Hd,p=a.Yg,q=a.Zg,v=a.Od,w=a.kh,y=a.vc;return(0,_ds.R)('<devsite-dialog class="devsite-credentials-dialog" id="'+_ds.W(a.dg)+'"><div class="devsite-dialog-contents">'+HP(c,d,e,f,h,k,l,m,p,q,v,w,y)+'</div><div class="devsite-dialog-buttons">'+IP(b,c,g,l,y)+"</div></devsite-dialog>")},KP=function(a){return HP(a.Yb,a.credentials,a.od,a.pd,a.eg,a.yd,a.projectId,a.Hd,a.Yg,a.Zg,a.Od,a.kh,a.vc)},HP=function(a,
b,c,d,e,f,g,h,k,l,m,p,q){var v=_ds.R;e="<h3>"+_ds.S(e)+"</h3>";if(q){p="";if(l)p+="<div>Loading projects...</div><devsite-spinner></devsite-spinner>";else if(k)p+='Sorry. We couldn\'t load your projects. You can visit <a href="https://console.developers.google.com">Developers Console</a> to see them.';else if(0<h.length){p+='<label>Project</label><select class="devsite-credentials-dialog-selector">';k=h.length;for(l=0;l<k;l++)q=h[l],p+='<option value="'+_ds.W(q.id)+'"'+(g==q.id?" selected":"")+">"+
_ds.S(q.title)+"</option>";p+="</select>"}else p+='You have no projects. You can create one in the <a href="https://console.developers.google.com">Developers Console</a>.';a='<div class="devsite-credentials-dialog-projects">'+(0,_ds.R)(p)+'</div><div class="devsite-credentials-dialog-credentials">'+LP(a,b,c,d,f,g)+'</div><div class="devsite-credentials-dialog-oauth-message">'+MP(a,g,m)+"</div>"}else a='<p class="devsite-credentials-dialog-signin-message">',b='Sign in to <a href="'+(_ds.W(_ds.X(p))+
'">insert your credentials.</a>'),a=a+b+"</p>",a=(0,_ds.R)(a);return v(e+a)},NP=function(a){return IP(a.Mf,a.Yb,a.ag,a.projectId,a.vc)},IP=function(a,b,c,d,e){let f="";b="https://console.developers.google.com/apis/credentials/"+_ds.SC(b)+"?project="+_ds.RC(d);b=(0,_ds.zC)(b);f+='<button class="devsite-dialog-close" type="button">Cancel</button>';e&&("oauth"==c&&(f+='<a class="button devsite-credentials-dialog-view devsite-credentials-dialog-action '+(a?"":"button-disabled")+'" type="button" href="'+
_ds.W(_ds.X(b))+'" target="_blank">',f+="View</a>"),"api_key"==c&&(f+='<button class="devsite-credentials-dialog-insert devsite-credentials-dialog-action" type="button"'+(a?"":" disabled")+">Insert</button>"));return(0,_ds.R)(f)},OP=function(a){return LP(a.Yb,a.credentials,a.od,a.pd,a.yd,a.projectId)},LP=function(a,b,c,d,e,f){let g="";f="https://console.developers.google.com/apis/credentials?project="+_ds.RC(f);f=(0,_ds.zC)(f);if(e)if(d)g+="<div>Loading credentials...</div><devsite-spinner></devsite-spinner>";
else if(c)g+='Sorry. We couldn\'t load the credentials for this project. You can visit the <a href="https://console.developers.google.com">Developers Console</a> to see them.';else if(0<b.length){g+='<label>Credentials</label><select class="devsite-credentials-dialog-selector">';c=b.length;for(d=0;d<c;d++)e=b[d],g+='<option value="'+_ds.W(e.credential)+'"'+(a==e.credential?" selected":"")+">"+_ds.S(e.type)+": "+_ds.S(e.credential)+"</option>";g+="</select>"}else a='This project has no appropriate credentials. You can add one in the <a href="'+
(_ds.W(_ds.X(f))+'">Developers Console</a>.'),g+=a;return(0,_ds.R)(g)},PP=function(a){return MP(a.Yb,a.projectId,a.Od)},MP=function(a,b,c){let d="";a="https://console.developers.google.com/apis/credentials/"+_ds.SC(a)+"?project="+_ds.RC(b);a=(0,_ds.zC)(a);c&&(c='<b>Note:</b> For security, this credential can only be displayed in the <a href="'+(_ds.W(_ds.X(a))+'">Google API Console</a>. You can copy and paste it from there.'),d+=c);return(0,_ds.R)(d)};var VP=async function(a){try{await DevsiteApp.whenReady()}catch(d){a.remove();return}if(a.isConnected){if(!a.V){var b=a.querySelector(".replaceable-credential");b&&(b.hasAttribute("data-devsite-credential-type")&&a.setAttribute("type",b.getAttribute("data-devsite-credential-type")),a.className=b.className,a.classList.remove("replaceable-credential"),a.innerText=b.innerText);if(!a.hasAttribute("type"))return;QP(a);a.j=a.getAttribute("type");"api_key"===a.j?(a.K="api-key-credentials-dialog",a.setAttribute("data-modal-dialog-id",
"api-key-credentials-dialog"),a.setAttribute("data-title","Click to insert your API key"),a.R="Insert API key"):"oauth"===a.j&&(a.K="oauth-credentials-dialog",a.setAttribute("data-modal-dialog-id","oauth-credentials-dialog"),a.setAttribute("data-title","Click to view your OAuth client credentials"),a.R="View OAuth client credentials");a.setAttribute("projects-loading","");a.setAttribute("credentials-loading","");a.V=!0}if("api_key"===a.j||"oauth"===a.j){b=_ds.N(JP,{Mf:a.J,Yb:a.D,credentials:a.v,od:a.hasAttribute("credentials-error"),
pd:a.hasAttribute("credentials-loading"),ag:a.j,dg:a.K,eg:a.R,yd:a.G,projectId:a.C,Hd:a.F,Yg:a.hasAttribute("projects-error"),Zg:a.hasAttribute("projects-loading"),Od:a.N,kh:a.T,vc:a.L});var c=document.body.querySelector(`#${a.K}`);c?a.h=c:(document.body.appendChild(b),a.h=b);RP(a);SP(a);TP(a)}UP(a)}},UP=function(a){a.H.listen(document.body,"devsite-dialog-show",()=>{WP(a,"Credentials Dialog Shown")});a.H.listen(a,"click",()=>{XP(a)})},WP=function(a,b){a.dispatchEvent(new CustomEvent("devsite-analytics-observation",
{detail:{category:"Credentials Dialog",action:b},bubbles:!0}))},XP=async function(a){QP(a);await YP(a);await ZP(a);a.h&&(_ds.M(a.h.querySelector(".devsite-dialog-contents"),KP,{Yb:a.D,credentials:a.v,od:a.hasAttribute("credentials-error"),pd:a.hasAttribute("credentials-loading"),eg:a.R,yd:a.G,projectId:a.C,Hd:a.F,Yg:a.hasAttribute("projects-error"),Zg:a.hasAttribute("projects-loading"),Od:a.N,kh:a.T,vc:a.L}),RP(a),SP(a));$P(a)},cQ=async function(a){if(a.h){var b=a.h.querySelector(".devsite-credentials-dialog-projects .devsite-credentials-dialog-selector");
b instanceof HTMLSelectElement&&(b=a.F[b.selectedIndex])&&(a.C=b.id,a.M=b.number,await ZP(a),aQ(a),bQ(a),$P(a))}},RP=function(a){const b=a.h.querySelector(".devsite-credentials-dialog-projects .devsite-credentials-dialog-selector");b instanceof HTMLSelectElement&&a.H.listen(b,"change",()=>{cQ(a)})},SP=function(a){const b=a.h.querySelector(".devsite-credentials-dialog-credentials .devsite-credentials-dialog-selector");b instanceof HTMLSelectElement&&a.H.listen(b,"change",()=>{if(a.h){var c=a.h.querySelector(".devsite-credentials-dialog-credentials .devsite-credentials-dialog-selector");
c instanceof HTMLSelectElement&&(a.D=a.v[c.selectedIndex].credential,aQ(a),bQ(a),$P(a))}})},TP=function(a){var b=a.h.querySelector(".devsite-credentials-dialog-insert");b&&a.H.listen(b,"click",()=>{a.innerText=a.D;a.h.open=!1;WP(a,"Credentials Dialog Successful Insert")});(b=a.h.querySelector(".devsite-credentials-dialog-view"))&&a.H.listen(b,"click",()=>{WP(a,"Credentials Dialog Successful View")})},QP=function(a){const b=document.querySelector("devsite-user");b&&(a.L=b.hasAttribute("signed-in"));
b&&b.hasAttribute("sign-in-url")&&(a.T=b.getAttribute("sign-in-url"))},YP=async function(a){if(a.L){a.setAttribute("projects-loading","");a.removeAttribute("projects-error");a.G=!1;try{const b=await _ds.dj("/profile/projects",null,"GET",!0),c=_ds.Pe(_ds.hI,b);a.F=dQ(c);0<a.F.length&&(a.C=a.F[0].id,a.M=a.F[0].number,a.G=!0)}catch(b){a.setAttribute("projects-error",""),a.F=[],WP(a,"Credentials Dialog Projects Error")}finally{a.removeAttribute("projects-loading")}}},ZP=async function(a){if(a.L&&a.M&&
a.C){a.setAttribute("credentials-loading","");a.removeAttribute("credentials-error");try{var b="";"api_key"==a.j&&(b=await _ds.dj("/profile/api_keys",JSON.stringify({project_id:a.C})));"oauth"==a.j&&(b=await _ds.dj("/profile/oauth_clients",JSON.stringify({project_number:a.M})));a.v=eQ(b)}catch(c){a.setAttribute("credentials-error",""),a.v=[],WP(a,"Credentials Dialog Credentials Error")}finally{a.removeAttribute("credentials-loading")}0<a.v.length&&(a.D=a.v[0].credential);b=!a.hasAttribute("credentials-loading")&&
!a.hasAttribute("credentials-error")&&0<a.v.length;a.J=a.G&&b;a.N="oauth"==a.j&&a.J}},$P=function(a){a.h&&(_ds.M(a.h.querySelector(".devsite-dialog-buttons"),NP,{Mf:a.J,ag:a.j,projectId:a.C,vc:a.L,Yb:a.D}),TP(a))},dQ=function(a){return _ds.Hb(a,_ds.fI,1).sort((b,c)=>_ds.A(b,2).localeCompare(_ds.A(c,2))).map(b=>({id:_ds.A(b,2),number:_ds.Ie(b,3).toString(),title:b.getTitle()}))},eQ=function(a){a=JSON.parse(a);return Object.entries(a).sort((b,c)=>b[0].localeCompare(c[0])).map(b=>({credential:b[0],type:b[1].type}))},
aQ=function(a){a.h&&(_ds.M(a.h.querySelector(".devsite-credentials-dialog-credentials"),OP,{Yb:a.D,credentials:a.v,od:a.hasAttribute("credentials-error"),pd:a.hasAttribute("credentials-loading"),projectId:a.C,yd:a.G}),SP(a))},bQ=function(a){a.h&&_ds.M(a.h.querySelector(".devsite-credentials-dialog-oauth-message"),PP,{Od:a.N,Yb:a.D,projectId:a.C})},fQ=class extends _ds.G{constructor(){super();this.H=new _ds.I;this.J=this.V=!1;this.j=this.D="";this.v=[];this.h=null;this.R=this.K="";this.G=!1;this.M=
this.C="";this.F=[];this.N=!1;this.T="";this.L=!1;this.$=new _ds.uk(()=>VP(this),250)}connectedCallback(){this.$.ua()}disconnectedCallback(){_ds.J(this.H);var a=!document.querySelector(`devsite-credentials-dialog[type="${this.j}"]`);this.hasAttribute("data-modal-dialog-id")&&a&&(a=document.body.querySelector(`#${this.getAttribute("data-modal-dialog-id")}`))&&document.body.removeChild(a)}};fQ.prototype.disconnectedCallback=fQ.prototype.disconnectedCallback;fQ.prototype.connectedCallback=fQ.prototype.connectedCallback;try{window.customElements.define("devsite-credentials-dialog",fQ)}catch(a){console.warn("devsite.app.customElement.DevsiteCredentialsDialog",a)};})(_ds_www);
